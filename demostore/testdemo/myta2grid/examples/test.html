<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>test</title>
    <link rel="stylesheet" href="../slick.grid.css" type="text/css"/>
    <link rel="stylesheet" href="../css/smoothness/jquery-ui-1.8.16.custom.css" type="text/css"/>
    <link rel="stylesheet" href="../base.css" type="text/css"/>
</head>
<style>
    .slick-cell-checkboxsel {
        background: #f0f0f0;
        border-right-color: silver;
        border-right-style: solid;
    }
</style>
<body>
<div id="myGrid" style="width:100%;height:500px;"></div>
<button id="exportExcel">导出</button>

</body>

<script src="../lib/firebugx.js"></script>
<script src="../lib/jquery-1.7.min.js"></script>
<script src="../lib/jquery-ui-1.8.16.custom.min.js"></script>
<script src="../lib/jquery.event.drag-2.2.js"></script>


<script src="../slick.core.js"></script>
<script src="../slick.dataview.js"></script>
<script src="../plugins/slick.autotooltips.js"></script>
<script src="../plugins/slick.cellcopymanager.js"></script>
<script src="../plugins/slick.cellrangedecorator.js"></script>
<script src="../plugins/slick.cellrangeselector.js"></script>
<script src="../plugins/slick.cellselectionmodel.js"></script>
<script src="../plugins/slick.checkboxselectcolumn.js"></script>
<script src="../plugins/grid.radioselect.js"></script>

<script src="../plugins/slick.headerbuttons.js"></script>
<script src="../plugins/slick.headermenu.js"></script>
<script src="../plugins/slick.rowmovemanager.js"></script>
<script src="../plugins/slick.rowselectionmodel.js"></script>
<script src="../slick.groupitemmetadataprovider.js"></script>
<script src="../slick.remotemodel.js"></script>
<script src="../slick.formatters.js"></script>
<script src="../slick.editors.js"></script>
<script src="../slick.grid.js"></script>
<script src="../slick.base.js"></script>


<script>



    var data=[];
//
    var columns=[
//        {id:"num",name:"编号",field:"num",sortable: true,dataType:"num"},
        {id:"name",name:"姓名",field:"name",sortable: true,dataType:"string",width:200},
        {id:"img",name:"图片",formatter:Slick.Formatters.ImageModel,image:"add.png"},//图片
        {id:"collection",name:"码表",field:"collection",formatter:Slick.Formatters.collection,collection:"AKC269",sortable: true},//码表
        {id:"date",name:"日期",field:"date",formatter:Slick.Formatters.format,format:"yyyy-MM-dd hh:mm:ss",align:"right"},//日期显示
        {id:"style",name:"样式",field:"style1",align:"right",color:"red",backgroundColor:"#ccc",display:""},//样式
        {id:"numtest",name:"表达式测试",field:"numtest",onclick:"Test(this)",ondblclick:"Test2(1)"},
        {id:"bke005",name:"表达式",field:"bke005",formatter:Slick.Formatters.valueExpression,
            valueExpression:"(Number(bke005)==3)?bke005='终审':bke005=bke005",styleExpression:"(Number(bke005)<=0)?{background_color:'red'}:null"}
    ];
//
//
    function Test(e){
        console.log("aa");
    }
    function Test2(num){
        console.log(num);
    }

    function exportExcel(){

    }


    $(function(){
        for (var i = 0; i < 3; i++) {
            var d = (data[i] = {});
            d["num"]=i;
            d["name"]="小明"+i;
            d["collection"]=(i%2==0);
            d["date"]=new Date();
            d["style1"]="样式";
            d["numtest"]=i;
            d["bke005"]=i;
        }
        var options={
            enableCellNavigation: true,//就是一个优化速度的
//          forceFitColumns:true,//自动列的宽度使填满表格;这时候宽度可能不起作用
            editable: true,
            enableColumnReorder: false,
            asyncEditorLoading: false,
            topPanelHeight: 25,

//          url:"url地址",
            selectType:"checkbox",//checkbox || radio
            autoEdit: false,
            allowExport:true,
            exportExcelName:"导出",


        }

       var mygrid=new ta2CreateSlickGrid("#myGrid", columns, options,data);
        $("#exportExcel").bind("click",function(){


            mygrid.exportDefaultGridData("xuanze")
        })







})




















</script>
</html>